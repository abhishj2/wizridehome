
<!-- Compact Search Summary -->
<div class="search-summary" *ngIf="searchParams">
  <div class="container">
    <div class="summary-content">
      <div class="summary-info">
        <div class="route-summary">
          <div class="route-locations">
            <div class="location-group">
              <span class="from">{{ searchParams.from }}</span>
              <span class="location-detail" *ngIf="searchParams.pickupLocation">{{ searchParams.pickupLocation }}</span>
            </div>
            <i class="fas fa-arrow-right"></i>
            <div class="location-group">
              <span class="to">{{ searchParams.to }}</span>
              <span class="location-detail" *ngIf="searchParams.dropLocation">{{ searchParams.dropLocation }}</span>
            </div>
          </div>
          <div class="journey-details">
            <span class="date">{{ formatDate(searchParams.date) }}</span>
            <span class="passengers">{{ searchParams.passengers }} seats</span>
          </div>
        </div>
      </div>
      <div class="summary-actions">
        <button class="modify-btn" (click)="modifySearch()">Modify</button>
        <button class="request-btn" (click)="requestCarAddition()">Request for Addition</button>
      </div>
    </div>
  </div>
</div>

<!-- Main Content -->
<main class="results-main">
  <div class="container">
    <div class="results-layout">
      
      <!-- Left Column - Vehicle Results -->
      <div class="results-column">
        <!-- <div class="results-header-section">
          <h2 class="results-title">
            {{ searchParams?.type === 'shared' ? 'Shared Cab' : 'Reserved Cab' }} Options
          </h2>
          <p class="results-subtitle">
            {{ vehicleOptions.length }} vehicles available for your journey
          </p>
        </div> -->

        <!-- Loading State -->
        <div class="loading-state" *ngIf="isLoading">
          <div class="loading-spinner"></div>
          <p>Finding the best options for you...</p>
        </div>

        <!-- Vehicle Cards -->
        <div class="vehicle-cards" *ngIf="!isLoading">
          <div class="card" *ngFor="let vehicle of vehicleOptions">
            
            <!-- Date Hanger -->
            <div class="date-hanger">
              <div class="date-content">
                <span class="date-text">{{ formatDate(searchParams?.date || '') }}</span>
              </div>
            </div>
            
    <!-- Route -->
    <div class="route">
      <div class="vehicle">
        <img [src]="vehicle.image" [alt]="vehicle.name">
        <div class="vehicle-info">
          <h3>{{ vehicle.name }}</h3>
        </div>
      </div>
      
      <div class="route-column">
        <div class="route-code">{{ vehicle.route.from.code }}</div>
        <div class="location">{{ vehicle.route.from.name }} 
          <div class="sub-location" *ngIf="vehicle.pickupLocation">({{ vehicle.pickupLocation }})</div>
        </div>
      </div>

      <div class="route-visualization">
        <div class="route-line">
          <div class="route-node start-node"></div>
          <div class="route-car">
            <img src="../../assets/images/bgremovecar.png" alt="Car">
          </div>
          <div class="route-node end-node"></div>
        </div>
        <div class="route-details">
          <div class="time">{{ vehicle.departureTime }}</div>
          <div class="duration">{{ vehicle.duration }}</div>
        </div>
      </div>

      <div class="route-column">
        <div class="route-code">{{ vehicle.route.to.code }}</div>
        <div class="location">{{ vehicle.route.to.name }}
          <div class="sub-location" *ngIf="vehicle.dropLocation">({{ vehicle.dropLocation }})</div>
        </div>
      </div>

      <div class="price-info">
       
        <div class="price">₹{{ vehicle.price.toFixed(0) }}</div>
      <div style="margin-top: 18px;">
        <p>{{ vehicle.seatsLeft }} Seat Left</p>
      </div>
      </div>
    </div>

    <!-- Details -->
    <!-- <div class="details">
      <div class="duration">{{ formatDate(searchParams?.date || '') }}</div>
    </div> -->

            <!-- Options -->
            <div class="options">
              <!-- Column 1: AC/Amenities -->
              <div class="option-item">
                <div class="default-amenities">
                  <div class="amenity-item">
                    <i class="fas fa-snowflake"></i>
                    <span>AC</span>
                  </div>
                </div>
                <div class="hover-dropdowns">
                  <div class="dropdown">
                    <i class="fas fa-list-alt"></i>
                    <span>Amenities</span>
                    <div class="dropdown-content">
                      {{ vehicle.amenities.join(', ') }}.
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Column 2: Luggage/Instructions -->
              <div class="option-item">
                <div class="default-amenities">
                  <div class="amenity-item">
                    <i class="fas fa-suitcase"></i>
                    <span>Luggage</span>
                  </div>
                </div>
                <div class="hover-dropdowns">
                  <div class="dropdown">
                    <i class="fas fa-info-circle"></i>
                    <span>Instructions</span>
                    <div class="dropdown-content">
                      Arrive 15 minutes before departure. Bring a valid ID. Follow crew instructions.
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Column 3: Refreshment/Cancellation Policy -->
              <div class="option-item">
                <div class="default-amenities">
                  <div class="amenity-item">
                    <i class="fas fa-coffee"></i>
                    <span>Refreshment</span>
                  </div>
                </div>
                <div class="hover-dropdowns">
                  <div class="dropdown">
                    <i class="fas fa-ban"></i>
                    <span>Cancellation Policy</span>
                    <div class="dropdown-content">
                      Cancel 24 hours prior for a full refund. 50% refund within 12 hours.
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Column 4: Select Seat Button -->
              <div class="select-btn-card">
                <button class="btn" (click)="selectSeat(vehicle)">Select Seat</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column - Promotional Ads -->
      <div class="sidebar-column">
        <div class="promotional-ads">
          
          <!-- Japan Trip Ad -->
          <div class="ad-card japan-ad">
            <div class="ad-image">
              <img src="https://images.unsplash.com/photo-1493976040374-85c8e12f0c0e?w=300&h=200&fit=crop" alt="Japan Trip">
            </div>
            <div class="ad-content">
              <h3 class="ad-title">Japan Trip</h3>
              <p class="ad-description">
                8 Days Trip in September. Come with Us on a Trip of a Lifetime. Check more details.
              </p>
            </div>
          </div>

          <!-- Kazakhstan Ad -->
          <div class="ad-card kazakhstan-ad">
            <div class="ad-image">
              <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=300&h=200&fit=crop" alt="Kazakhstan">
            </div>
            <div class="ad-content">
              <h3 class="ad-title">Kazakhstan</h3>
              <p class="ad-description">
                Explore the beautiful landscapes of Kazakhstan. 10 Days Adventure Package.
              </p>
            </div>
          </div>

          <!-- Europe Tour Ad -->
          <div class="ad-card europe-ad">
            <div class="ad-image">
              <img src="https://images.unsplash.com/photo-1467269204594-9661b134dd2b?w=300&h=200&fit=crop" alt="Europe Tour">
            </div>
            <div class="ad-content">
              <h3 class="ad-title">Europe Tour</h3>
              <p class="ad-description">
                Discover the charm of Europe. 15 Days Multi-Country Tour Package.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Seat Selection Popup -->
<div class="seat-popup-overlay" *ngIf="showSeatPopup" (click)="closeSeatPopup()">
  <div class="seat-popup" (click)="$event.stopPropagation()">
    <!-- Popup Header -->
    <div class="popup-header">
      <div class="popup-title">
        <h2>Select Your Seat</h2>
        <p>All seats are front-facing</p>
      </div>
      <button class="close-btn" (click)="closeSeatPopup()">×</button>
    </div>

    <!-- Popup Content -->
    <div class="popup-content">
      <!-- Car Layout -->
      <div class="car-layout">
        <div class="car-container">
          <!-- Passenger Seats Above Car -->
          <div class="seat-row front-row">
            <div class="seat passenger-seat" 
                 [class.booked]="seat.status === 'booked'" 
                 [class.selected]="seat.status === 'selected'"
                 (click)="selectSeatFromPopup(seat)"
                 *ngFor="let seat of frontSeats; let i = index">
              <img src="../../assets/images/carmodule/seat.png" alt="Seat">
              <span class="seat-number">{{ seat.number }}</span>
              <span class="seat-price">₹{{ seat.price }}</span>
            </div>
          </div>

          <div class="seat-row middle-row">
            <div class="seat passenger-seat" 
                 [class.booked]="seat.status === 'booked'" 
                 [class.selected]="seat.status === 'selected'"
                 (click)="selectSeatFromPopup(seat)"
                 *ngFor="let seat of middleSeats; let i = index">
              <img src="../../assets/images/carmodule/seat.png" alt="Seat">
              <span class="seat-number">{{ seat.number }}</span>
              <span class="seat-price">₹{{ seat.price }}</span>
            </div>
          </div>

          <div class="seat-row back-row">
            <div class="seat passenger-seat" 
                 [class.booked]="seat.status === 'booked'" 
                 [class.selected]="seat.status === 'selected'"
                 (click)="selectSeatFromPopup(seat)"
                 *ngFor="let seat of backSeats; let i = index">
              <img src="../../assets/images/carmodule/seat.png" alt="Seat">
              <span class="seat-number">{{ seat.number }}</span>
              <span class="seat-price">₹{{ seat.price }}</span>
            </div>
          </div>

          <!-- Car Image Below Seats -->
          <img src="../../assets/images/carmodule/car2.png" alt="Car" class="car-image">
          
          <!-- Driver Seat -->
          <div class="seat driver-seat">
            <img src="../../assets/images/carmodule/driver.png" alt="Driver">
          </div>
        </div>
      </div>

      <!-- Legend -->
      <div class="seat-legend">
        <div class="legend-item">
          <img src="../../assets/images/carmodule/seat.png" alt="Available">
          <span>Available Seat</span>
        </div>
        <div class="legend-item">
          <img src="../../assets/images/carmodule/seat.png" alt="Selected" class="selected">
          <span>Selected Seat</span>
        </div>
        <div class="legend-item">
          <img src="../../assets/images/carmodule/driver.png" alt="Driver">
          <span>Driver's Seat</span>
        </div>
        <div class="legend-item">
          <img src="../../assets/images/carmodule/seat.png" alt="Booked" class="booked">
          <span>Booked Seat</span>
        </div>
      </div>
    </div>

    <!-- Popup Footer -->
    <div class="popup-footer">
      <button class="proceed-btn" (click)="proceedToBooking()" [disabled]="!selectedSeat">
        Proceed
      </button>
    </div>
  </div>
</div>